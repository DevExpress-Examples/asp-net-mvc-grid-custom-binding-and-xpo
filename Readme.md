<!-- default file list -->
*Files to look at*:

* [OrdersController.cs](./CS/XPCustomBindingExample/Controllers/OrdersController.cs) (VB: [OrdersController.vb](./VB/XPCustomBindingExample/Controllers/OrdersController.vb))
* [DatabaseSchemaHelper.cs](./CS/XPCustomBindingExample/XPO/DatabaseSchemaHelper.cs) (VB: [DatabaseSchemaHelper.vb](./VB/XPCustomBindingExample/XPO/DatabaseSchemaHelper.vb))
* **[XpoBindingHandlers.cs](./CS/XPCustomBindingExample/XPO/XpoBindingHandlers.cs) (VB: [XpoBindingHandlers.vb](./VB/XPCustomBindingExample/XPO/XpoBindingHandlers.vb))**
* [XpoHelper.cs](./CS/XPCustomBindingExample/XPO/XpoHelper.cs) (VB: [XpoHelper.vb](./VB/XPCustomBindingExample/XPO/XpoHelper.vb))
<!-- default file list end -->
# How to bind an ASP.NET MVC GridView extension to a table with an unknown schema using Custom Data Binding and XPO


<strong>Disclaimer:</strong><br>This example demonstrates an edge-case scenario and uses XPO in an uncommon way. Refer to the following articles for XPO best practices:<br><a href="https://www.devexpress.com/Support/Center/p/K18061">How to use XPO in an ASP.NET (Web) application</a><br><a href="https://www.devexpress.com/Support/Center/p/K18525">How to bind editors to XPO objects in an ASP.NET MVC application</a><br><br><strong>Targets:</strong><br>The approach demonstrated in this example can be used when you need to take advantage of the <a href="https://documentation.devexpress.com/AspNet/14760/ASP-NET-MVC-Extensions/Grid-View/Concepts/Binding-to-Data/Binding-to-Large-Data-Database-Server-Mode">partial data loading</a> feature, but cannot use statically declared business models mapped to the database. This approach can be used to support adding/removing database columns without modifying the application code, to implement a generic View consuming data from an arbitrary table (or even database) selected by the user, or to implement a SaaS application.<br><br><strong>Prerequisites:</strong><br>This example is based on the following technologies:<br>1. <a href="https://documentation.devexpress.com/CoreLibraries/1998/DevExpress-ORM-Tool">eXpress Persistent Objects</a> (aka XPO) are used as a data access layer. Refer to the tutorials in our online documentation to get started with XPO: <a href="https://documentation.devexpress.com/CoreLibraries/2263/DevExpress-ORM-Tool/Getting-Started">Getting Started</a>.<br>2. XPO supports dynamic mapping to the database tables without declaring any classes. Refer to this Knowledge Base article to learn more about this functionality: <a href="https://www.devexpress.com/Support/Center/p/K18482">How to create persistent metadata on the fly and load data from an arbitrary table</a>.<br>3. Our <a href="https://documentation.devexpress.com/AspNet/8998/ASP-NET-MVC-Extensions/Grid-View/Overview/Overview-GridView">GridView</a> component for ASP.NET MVC platform has an API that allows you to populate a grid with data manually taking into account the current grid state (filtering, sorting, grouping) - <a href="https://documentation.devexpress.com/AspNet/14374/ASP-NET-MVC-Extensions/Grid-View/Concepts/Binding-to-Data/Custom-Data-Binding/Overview/Custom-Data-Binding-Overview">Custom Data Binding</a>.<br>4. XPO provides components that can be used to load objects without knowing their types at compile time (<a href="https://documentation.devexpress.com/CoreLibraries/2031/DevExpress-ORM-Tool/Feature-Center/Data-Representation/XPCollection">XPCollection</a>) or building complex queries with grouping, filtering, sorting and data aggregation (<a href="https://documentation.devexpress.com/CoreLibraries/2068/DevExpress-ORM-Tool/Concepts/XPView-Concepts">XPView</a>).<br><br>Refer to our online documentation to understand concepts used in this example.<br><br><strong>Implementation details:</strong><br><br><strong>1.</strong> This example extends a standard approach of connecting an ASP.NET application to an XPO data store described in this article: <a href="https://www.devexpress.com/Support/Center/p/K18061">How to use XPO in an ASP.NET (Web) application</a>. In this scenario, the persistent classes schema can be changed at run time. To address this requirement, it is necessary to create a separate <a href="https://documentation.devexpress.com/CoreLibraries/2121/DevExpress-ORM-Tool/Feature-Center/Connecting-to-a-Data-Store/Data-Access-Layer">Data Access Layer</a> for each user, instead of sharing a single <a href="https://documentation.devexpress.com/CoreLibraries/DevExpress.Xpo.ThreadSafeDataLayer.class">ThreadSafeDataLayer</a> instance between all users as it recommended to do in regular scenarios. Refer to the <em>XPO\XpoHelper.cs(vb)</em> file for implementation details.<br><strong>2.</strong> To handle the concurrent access to a <a href="https://documentation.devexpress.com/CoreLibraries/DevExpress.Xpo.DB.IDataStore.class">data store</a>, this example uses the DataStorePool component. XPO automatically creates DataStorePool when the connection string contains the special parameter. The <a href="https://documentation.devexpress.com/CoreLibraries/DevExpress.Xpo.XpoDefault.GetConnectionPoolString.overloads">XpoDefault.GetConnectionPoolString</a> method is used to prepare such connection string.<br><strong>3.</strong> The GetNewSession and GetNewUnitOfWork methods implemented in the extended XpoHelper class accept an <a href="https://documentation.devexpress.com/CoreLibraries/DevExpress.Xpo.Metadata.XPDictionary.class">XPDictionary</a> instance as a last parameter. XPDictionary provides metadata information used to map persistent objects to database tables. In the example, the XPDictionary instance is prepared in the <em>XPO\DatabaseSchemaHelper.cs(vb)</em> file. This implementation is intended for demonstration purposes only. In real projects, it should be replaced with a custom implementation integrated with the application architecture and business requirements.<br><strong>4.</strong> The <em>XPO\XpoBindingHandlers.cs(vb)</em> file contains a universal class that can be used in real projects without modifications. It provides the <a href="https://documentation.devexpress.com/AspNet/14553/ASP-NET-MVC-Extensions/Grid-View/Concepts/Binding-to-Data/Custom-Data-Binding/Implementation-of-Typed-Method-Delegates">implementation of typed method delegates</a> required to calling to a grid view model's <a href="https://documentation.devexpress.com/AspNet/DevExpress.Web.Mvc.GridViewModel.ProcessCustomBinding.overloads">GridViewModel.ProcessCustomBinding</a> method. The usage is demonstrated in the <em>Controllers\OrdersController.cs(vb)</em> file.<br><br><strong>How to use:</strong><br><br>To add this functionality to an existing ASP.NET MVC project, do the following:<br><strong>1.</strong> Copy the <em>XPO\XpoHelper.cs(vb)</em> file to your project. If the project already contains a similar helper class copied from the <a href="https://www.devexpress.com/Support/Center/p/K18061">K18061</a> article, you can replace it or use both the implementations together.<br><strong>2.</strong> Add required connection strings to your Web.config file. Refer to the Microsoft documentation to learn more about the <strong><connectionStrings></strong> configuration section: <a href="https://docs.microsoft.com/en-us/aspnet/mvc/overview/getting-started/introduction/creating-a-connection-string">Creating a Connection String and Working with SQL Server LocalDB</a>, <a href="https://msdn.microsoft.com/en-us/library/jj653752(v=vs.110).aspx">SQL Server Connection Strings for ASP.NET Web Applications</a>. If the application uses a database other than MS SQL Server, it is necessary to add a special parameter to a connection string. Refer to the following article for details: <a href="https://www.devexpress.com/Support/Center/p/K18445">How to create a correct connection string for XPO providers</a>.<br><strong>3.</strong> Copy the <em>XPO\XpoBindingHandlers.cs(vb)</em> file to your project.<br><strong>4.</strong> Using examples provided in the <em>XPO\DatabaseSchemaHelper.cs</em><em>(vb)</em> file and the <a href="https://www.devexpress.com/Support/Center/p/K18482">K18482</a> article, implement a helper class that builds metadata to map persistent objects to specific tables according to your business requirements.<br><br>Use the XpoBindingHandler class in your Controllers the same way as it is demonstrated in the <em>Controllers\OrdersController.cs(vb)</em> file. This class is independent from other parts of the project and can be re-used without modifications.

<br/>


